
user  root;
worker_processes  1;

error_log  /usr/local/openresty/nginx/logs/error.log warn;
pid        /var/run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  logs/access.log   main;
    error_log  logs/error.log warn;
    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  65;

    server {
        listen 88;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header REMOTE-HOST $remote_addr;
        proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;

        location / {
           root /home/clms/html/public;
           index index.html set.html;
           add_header 'Access-Control-Allow-Origin' *;
           access_by_lua_file /etc/nginx/lua/request_access.lua;
        }
        location ^~ /userapi/ {
            proxy_pass http://10.80.84.106:8080/;
        }

        location ^~ /partnerapi/ {
            proxy_pass http://10.80.84.106:8081/;
        }

        location ^~ /product/ {
            proxy_pass http://10.80.84.106:8082/;
        }

        location ^~ /transportapi/ {
            proxy_pass http://10.80.84.106:52413/;
        }

        location ^~ /loginapi/ {
            proxy_pass http://10.80.84.106:52412/;
        }

        location ^~ /rechargeapi/ {
            proxy_pass http://10.80.84.106:8087/;
        }

        location ^~ /messageapi/ {
            proxy_pass http://10.80.84.106:8090/;
        }

        location ^~ /purchaseapi/ {
             proxy_pass http://10.80.84.106:8099/;
        }
        location ^~ /warehouseapi/ {
             proxy_pass http://10.80.84.106:8071/;
        }

    }

    server {
        listen 80;

        listen 443 ssl;
        server_name wechat-test.datuodui.com;

        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header REMOTE-HOST $remote_addr;
        proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;

        ssl_certificate /usr/local/openresty/nginx/conf/star.datuodui.com_nginx.crt;
        ssl_certificate_key /usr/local/openresty/nginx/conf/clms_datuodui.key;
        access_log  logs/access.log   main;
        error_log  logs/error.log warn;
        location /{
                    proxy_pass http://10.80.84.106:86/;
                }
        location ^~ /yingyan/ {
                    proxy_pass http://yingyan.baidu.com/api/v3/;
                }
    }
 server {
        listen 87;

        listen 443 ssl;
        server_name wechat.datuodui.com;

        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header REMOTE-HOST $remote_addr;
        proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;

        ssl_certificate /usr/local/openresty/nginx/conf/star.datuodui.com_nginx.crt;
        ssl_certificate_key /usr/local/openresty/nginx/conf/clms_datuodui.key;

        location /{
                    proxy_pass http://10.80.84.106:86/;
                }
    }

     server {
                    listen 80;
                    listen 443 ssl;
                    server_name www.datuodui.cn www.datuodui.com datuodui.com datuodui.cn;
                    proxy_set_header X-Real-IP $remote_addr;
                    proxy_set_header Host $host;
                    proxy_set_header REMOTE-HOST $remote_addr;
                    proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;

                    ssl_certificate /usr/local/openresty/nginx/conf/star.datuodui.com_nginx.crt;
                     ssl_certificate_key /usr/local/openresty/nginx/conf/clms_datuodui.key;

                    location /{
                        root /home/clms/cn;
                        index index.html;
                        add_header 'Access-Control-Allow-Origin' *;
                    }
                }


     server {
        listen 82;
         proxy_set_header X-Real-IP $remote_addr;
                            proxy_set_header Host $host;
                            proxy_set_header REMOTE-HOST $remote_addr;
                            proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;
         location /{
                                root /home/clms/demo;
                                index login.html;
                                add_header 'Access-Control-Allow-Origin' *;
                            }
     }

     server {
        listen 84;
             proxy_set_header X-Real-IP $remote_addr;
                                    proxy_set_header Host $host;
                                    proxy_set_header REMOTE-HOST $remote_addr;
                                    proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;
                 location /{
                                        root /home/clms/admin;
                                        index login.html;
                                        add_header 'Access-Control-Allow-Origin' *;


                                    }

                 location ^~ /userapi/ {
                                       proxy_pass http://10.80.84.106:8080/;
                                                              }
                 location ^~ /loginapi/ {
                             proxy_pass http://10.80.84.106:52412/;
                        }
     }

  server {
                    listen 80;
                    listen 443 ssl;
                    server_name draw.datuodui.com;
                    proxy_set_header X-Real-IP $remote_addr;
                    proxy_set_header Host $host;
                    proxy_set_header REMOTE-HOST $remote_addr;
                    proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;

                    ssl_certificate /usr/local/openresty/nginx/conf/star.datuodui.com_nginx.crt;
                    ssl_certificate_key /usr/local/openresty/nginx/conf/clms_datuodui.key;

                    location ^~ / {
                        proxy_set_header Host $host;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_pass http://10.80.84.106:52777/;
                     }
                }




}